start:
    ; Ввод строки в буфер
    mov %esi buf       ; Указатель на буфер
    mov %ecx 100       ; Максимальная длина
    call scans         ; Вызов функции ввода
    
    ; Вывод содержимого буфера
    mov %esi buf       ; Указатель на буфер
    call puts          ; Вывод введённой строки
    hlt                ; Остановка процессора

; Функция ввода строки с echo
scans:
    cmp %ecx 0         ; Проверка остатка длины
    re                 ; Если 0 - возврат
    
    int 1              ; Ввод символа (сохраняется на стек)
    pop %eax           ; Извлекаем символ в %eax
    push %eax          ; Копируем символ обратно на стек
    int 2              ; Выводим символ (echo)
    
    cmp %eax 10        ; Проверка на LF (новую строку)
    re                 ; Если LF - возврат
    
    stob %esi %eax     ; Сохраняем символ в память
    dex %ecx           ; Уменьшаем счётчик длины
    jmp scans          ; Повторяем

; Функция вывода строки
puts:
    lodb %esi %eax     ; Загрузка символа
    cmp %eax 0         ; Проверка на конец строки
    re                 ; Если 0 - возврат
    push %eax          ; Кладем символ в стек
    int 2              ; Вывод символа
    jmp puts           ; Следующий символ

; Данные
buf: reserve 100 bytes  ; Буфер для ввода (100 байт)

